!function(f){f.fn.yiiGridView=function(e){return l[e]?l[e].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof e&&e?(f.error("Method "+e+" does not exist in jQuery.yiiGridView"),!1):l.init.apply(this,arguments)};var o={filterUrl:void 0,filterSelector:void 0,filterOnFocusOut:!0},d={},s={beforeFilter:"beforeFilter",afterFilter:"afterFilter"},c={},l={init:function(n){return this.each(function(){var i=f(this),t=f.extend({},o,n||{}),e=i.attr("id");void 0===d[e]&&(d[e]={}),d[e]=f.extend(d[e],{settings:t});var r=!1;a(i,"filter","change.yiiGridView keydown.yiiGridView",t.filterSelector,function(e){if("keydown"===e.type){if(13!==e.keyCode)return;r=!0}else if(r)return void(r=!1);return(t.filterOnFocusOut||"keydown"===e.type)&&l.applyFilter.apply(i),!1})})},applyFilter:function(){var e=f(this),i=d[e.attr("id")].settings,r={};f.each(f(i.filterSelector).serializeArray(),function(){this.name in r||(r[this.name]=[]),r[this.name].push(this.value)});var n=Object.keys(r);f.each(yii.getQueryParams(i.filterUrl),function(t,e){-1===n.indexOf(t)&&-1===n.indexOf(t.replace(/\[\d*\]$/,""))&&(f.isArray(e)||(e=[e]),t in r?f.each(e,function(e,i){f.inArray(i,r[t])&&r[t].push(i)}):r[t]=e)});var t=i.filterUrl.indexOf("?"),o=t<0?i.filterUrl:i.filterUrl.substring(0,t),l=i.filterUrl.indexOf("#");0<=t&&0<=l&&(o+=i.filterUrl.substring(l)),e.find("form.gridview-filter-form").remove();var a=f("<form/>",{action:o,method:"get",class:"gridview-filter-form",style:"display:none","data-pjax":""}).appendTo(e);f.each(r,function(t,e){f.each(e,function(e,i){a.append(f("<input/>").attr({type:"hidden",name:t,value:i}))})});var c=f.Event(s.beforeFilter);e.trigger(c),!1!==c.result&&(a.submit(),e.trigger(s.afterFilter))},setSelectionColumn:function(i){var t=f(this),e=f(this).attr("id");if(void 0===d[e]&&(d[e]={}),d[e].selectionColumn=i.name,i.multiple&&i.checkAll){var r="#"+e+" input[name='"+i.checkAll+"']",n=i.class?"input."+i.class:"input[name='"+i.name+"']",o="#"+e+" "+n+":enabled";a(t,"checkAllRows","click.yiiGridView",r,function(){t.find(n+":enabled").prop("checked",this.checked)}),a(t,"checkRow","click.yiiGridView",o,function(){var e=t.find(n).length==t.find(n+":checked").length;t.find("input[name='"+i.checkAll+"']").prop("checked",e)})}},getSelectedRows:function(){var e=f(this),i=d[e.attr("id")],t=[];return i.selectionColumn&&e.find("input[name='"+i.selectionColumn+"']:checked").each(function(){t.push(f(this).parent().closest("tr").data("key"))}),t},destroy:function(){var e=[".yiiGridView",s.beforeFilter,s.afterFilter].join(" ");this.off(e);var i=f(this).attr("id");return f.each(c[i],function(e,i){f(document).off(i.event,i.selector)}),delete d[i],this},data:function(){var e=f(this).attr("id");return d[e]}};function a(e,i,t,r,n){var o=e.attr("id"),l=c[o];if(void 0!==l&&void 0!==l[i]){var a=l[i];f(document).off(a.event,a.selector)}void 0===l&&(c[o]={}),f(document).on(t,r,n),c[o][i]={event:t,selector:r}}}(window.jQuery);